<!doctype html>
<!-- nav update: 2025-02-14 – unified site header -->
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>B.A.S.E — Settings</title>

  <link rel="icon" href="./lib/assets/images/logos/base-logo.png">
  <link rel="stylesheet" href="./styles/base.css">

  <script defer src="./Applications/JSON/app-registry.js"></script>
  <script defer src="./scripts/data.js"></script>
  <script defer src="./scripts/apps.js"></script>
  <script defer src="./scripts/main.js"></script>
  <script defer src="./scripts/nav.js"></script>
</head>
<body>
  <!-- Primary Navigation (GlassNav v2.1) -->
  <nav class="glassnav" role="navigation" aria-label="Primary">
    <div class="nav-inner">
      <a class="nav-logo" href="./index.html" aria-label="BASE home">
        <img src="./lib/assets/images/logos/base-logo.png" alt="BASE" height="44" width="44" loading="lazy">
      </a>

      <button class="nav-toggle" type="button" aria-label="Open navigation menu" aria-controls="primary-navigation" aria-expanded="false">
        <span class="icon-burger" aria-hidden="true">
          <span></span>
          <span></span>
          <span></span>
        </span>
        <span class="icon-close" aria-hidden="true">×</span>
      </button>

      <ul id="primary-navigation" class="nav-list">
        <li>
          <a class="nav-link" data-page="home" href="./index.html">
            <span class="label">Home</span>
            <svg class="underline" viewBox="0 0 120 14" preserveAspectRatio="none">
              <path d="M6,10 Q60,2 114,10" />
            </svg>
          </a>
        </li>
        <li>
          <a class="nav-link" data-page="briefing" href="./briefing.html">
            <span class="label">Briefing</span>
            <svg class="underline" viewBox="0 0 120 14" preserveAspectRatio="none">
              <path d="M6,10 Q60,2 114,10" />
            </svg>
          </a>
        </li>
        <li>
          <a class="nav-link" data-page="applications" href="./applications.html">
            <span class="label">Applications</span>
            <svg class="underline" viewBox="0 0 140 14" preserveAspectRatio="none">
              <path d="M6,10 Q70,2 134,10" />
            </svg>
          </a>
        </li>
        <li>
          <a class="nav-link" data-page="forms" href="./forms.html">
            <span class="label">Forms</span>
            <svg class="underline" viewBox="0 0 90 14" preserveAspectRatio="none">
              <path d="M6,10 Q45,2 84,10" />
            </svg>
          </a>
        </li>
        <li>
          <a class="nav-link" data-page="recoveries" href="./recoveries.html">
            <span class="label">Recoveries</span>
            <svg class="underline" viewBox="0 0 130 14" preserveAspectRatio="none">
              <path d="M6,10 Q65,2 124,10" />
            </svg>
          </a>
        </li>
        <li>
          <a class="nav-link" data-page="directory" href="./directory.html">
            <span class="label">Directory</span>
            <svg class="underline" viewBox="0 0 120 14" preserveAspectRatio="none">
              <path d="M6,10 Q60,2 114,10" />
            </svg>
          </a>
        </li>
        <li>
          <a class="nav-link is-active" data-page="settings" href="./settings.html" aria-current="page">
            <span class="label">Settings</span>
            <svg class="underline" viewBox="0 0 105 14" preserveAspectRatio="none">
              <path d="M6,10 Q52,2 99,10" />
            </svg>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <main class="container">
    <section class="card">
      <div class="card-head">
        <h2>Manage Applications</h2>
        <span id="apps-source-chip" class="chip" hidden>Loaded: defaults</span>
      </div>

      <div class="row gap8" style="justify-content:flex-end; flex-wrap:wrap;">
        <input id="apps-file-input" type="file" accept=".json,application/json" style="display:none">
        <button id="btn-reload-links-settings" class="btn ghost no-caret" type="button">Reload links</button>
        <button id="btn-add-app" class="btn success" type="button">Add Application</button>
        <button id="btn-save-apps" class="btn" type="button">Save Apps</button>
        <button id="btn-export-apps" class="btn primary" type="button">Validate &amp; Export JSON</button>
      </div>

      <div class="meta-grid" id="apps-meta-form">
        <label>Version
          <input id="apps-meta-version" type="text" placeholder="v2024.09">
        </label>
        <label>Last Updated
          <input id="apps-meta-updated" type="text" placeholder="2024-09-01 08:30">
        </label>
        <label>Updated By
          <input id="apps-meta-updated-by" type="text" placeholder="Inspector McRae">
        </label>
      </div>

      <div id="apps-errors" class="notice danger" hidden>
        <strong>Validation issues detected.</strong>
        <ul id="apps-errors-list"></ul>
      </div>

      <div id="apps-file-warning" class="notice" hidden>
        <strong>Local file access:</strong> Couldn’t read <span class="kbd">Applications/JSON/app-registry.js</span>.
        <div class="mt8">
          <label class="btn ghost" for="apps-file-input">Load registry…</label>
        </div>
      </div>

      <table class="table" id="tbl-apps">
        <thead>
          <tr><th>Name</th><th>URL</th><th>Icon Preview</th><th>Actions</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <div id="modal-add-app" class="modal" hidden>
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="add-app-title">
      <h3 id="add-app-title">Add Application</h3>
      <form id="form-add-app" class="form">
        <label>Name / Label
          <input id="app-label" type="text" required>
        </label>
        <label>URL
          <input id="app-href" type="url" required>
        </label>
        <label>Icon file (optional)
          <input id="app-icon-file" type="file" accept="image/*">
          <small class="muted">Embedded as base64 in apps.json</small>
        </label>
        <label>Icon URL (optional)
          <input id="app-icon-url" type="url" placeholder="./lib/assets/images/icons/icon-yourapp.png">
        </label>
        <div id="app-icon-preview-wrap" style="grid-column:1/-1;display:flex;align-items:center;gap:10px;min-height:48px;">
          <img id="app-icon-preview" class="icon-thumb" alt="Icon preview" hidden>
          <span class="muted" id="app-icon-preview-empty">No icon selected</span>
        </div>
        <div class="row" style="grid-column:1/-1;justify-content:flex-end;gap:8px">
          <button type="button" id="btn-cancel-app" class="btn">Cancel</button>
          <button type="submit" class="btn success">Add &amp; Download</button>
        </div>
      </form>
    </div>
  </div>
</body>
</html>
